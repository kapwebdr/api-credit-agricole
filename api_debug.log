2025-03-22 11:28:50,396 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:28:50,396 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:28:54,966 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 2/2 comptes traités avec succès

2025-03-22 11:28:54,967 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:30:18,231 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:30:18,231 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:30:22,048 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 2/2 comptes traités avec succès

2025-03-22 11:30:22,048 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:31:01,376 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:31:01,377 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:31:04,203 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:31:04,203 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:31:04,204 - ca_api - INFO - Traitement terminé avec succès
2025-03-22 11:39:51,427 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:39:51,427 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:39:55,619 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 2/2 comptes traités avec succès

2025-03-22 11:39:55,620 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:42:53,825 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:42:53,825 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:42:57,873 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 2/2 comptes traités avec succès

2025-03-22 11:42:57,873 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:43:28,197 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:43:28,197 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:43:31,575 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Erreur lors du traitement du compte 70089352734: [Errno 60] Operation timed out: '/Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx'

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 1/2 comptes traités avec succès

2025-03-22 11:43:31,575 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:44:33,077 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:44:33,077 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:44:37,087 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 2/2 comptes traités avec succès

2025-03-22 11:44:37,088 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:44:50,705 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:44:50,705 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:44:52,689 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: 
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:44:52,690 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 319, in process_ca_statement
    ht_col_rec = next(col for col in range(1, recettes_sheet.max_column + 1)
StopIteration
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:44:52,690 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:47:03,639 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:47:03,639 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:47:07,034 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Colonne 'Montant HT' non trouvée dans la feuille Recettes, utilisation de la valeur par défaut
Colonne 'TVA' non trouvée dans la feuille Recettes, utilisation de la valeur par défaut
Colonne 'Montant HT' non trouvée dans la feuille Dépenses, utilisation de la valeur par défaut
Colonne 'TVA' non trouvée dans la feuille Dépenses, utilisation de la valeur par défaut
Erreur lors du traitement: 
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:47:07,035 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 475, in process_ca_statement
    tva_col_rec = get_column_letter(next(i+1 for i, cell in enumerate(recettes_sheet[1]) if cell.value == "TVA"))
StopIteration
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:47:07,035 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:48:05,043 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:48:05,043 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:48:05,457 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Colonne 'Montant HT' non trouvée dans la feuille Recettes, utilisation de la valeur par défaut
Colonne 'TVA' non trouvée dans la feuille Recettes, utilisation de la valeur par défaut
Colonne 'Montant HT' non trouvée dans la feuille Dépenses, utilisation de la valeur par défaut
Colonne 'TVA' non trouvée dans la feuille Dépenses, utilisation de la valeur par défaut
Erreur lors du traitement: 
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:48:05,457 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 454, in process_ca_statement
    tva_col_rec = get_column_letter(next(i+1 for i, cell in enumerate(recettes_sheet[1]) if cell.value == "TVA"))
StopIteration
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:48:05,457 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:50:02,971 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:50:02,971 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:50:05,716 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: 
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:50:05,716 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 319, in process_ca_statement
    ht_col_rec = next(col for col in range(1, recettes_sheet.max_column + 1)
StopIteration
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:50:05,716 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:50:09,711 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:50:09,711 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:50:10,190 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: 
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:50:10,190 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 319, in process_ca_statement
    ht_col_rec = next(col for col in range(1, recettes_sheet.max_column + 1)
StopIteration
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:50:10,190 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:50:14,392 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:50:14,392 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:50:14,822 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: 
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:50:14,822 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 319, in process_ca_statement
    ht_col_rec = next(col for col in range(1, recettes_sheet.max_column + 1)
StopIteration
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:50:14,822 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:50:19,166 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:50:19,166 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:50:19,600 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: 
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:50:19,601 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 305, in process_ca_statement
    ht_col_rec = next(col for col in range(1, recettes_sheet.max_column + 1)
StopIteration
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:50:19,601 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:50:23,761 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:50:23,762 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:50:24,228 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:50:24,229 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:50:24,229 - ca_api - INFO - Traitement terminé avec succès
2025-03-22 11:52:28,852 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:52:28,852 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:52:31,554 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:52:31,554 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:52:31,555 - ca_api - INFO - Traitement terminé avec succès
2025-03-22 11:53:39,497 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:53:39,497 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:53:39,947 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:53:39,948 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:53:39,948 - ca_api - INFO - Traitement terminé avec succès
2025-03-22 11:55:02,565 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:55:02,565 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:55:05,086 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:55:05,086 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:55:05,086 - ca_api - INFO - Traitement terminé avec succès
2025-03-22 11:56:53,081 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:56:53,081 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:56:56,295 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: 'dict' object has no attribute 'create_sheet'
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:56:56,295 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 292, in process_ca_statement
    rules_sheet = workbook.create_sheet("Règles TVA")
AttributeError: 'dict' object has no attribute 'create_sheet'
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:56:56,296 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:57:16,543 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:57:16,543 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:57:16,987 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: 'str' object has no attribute 'book'
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:57:16,987 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 244, in process_ca_statement
    workbook = writer.engine.book
AttributeError: 'str' object has no attribute 'book'
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:57:16,987 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:57:21,671 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:57:21,671 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:57:22,133 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:57:22,133 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:57:22,133 - ca_api - INFO - Traitement terminé avec succès
2025-03-22 11:58:16,590 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:58:16,590 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:58:19,351 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: I/O operation on closed file
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:58:19,351 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 434, in process_ca_statement
    writer.close()
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/pandas/io/excel/_base.py", line 1353, in __exit__
    self.close()
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/pandas/io/excel/_base.py", line 1357, in close
    self._save()
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/pandas/io/excel/_openpyxl.py", line 110, in _save
    self.book.save(self._handles.handle)
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/workbook/workbook.py", line 386, in save
    save_workbook(self, filename)
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/writer/excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "/Users/kapweb/micromamba/lib/python3.9/zipfile.py", line 1272, in __init__
    self.start_dir = self.fp.tell()
ValueError: I/O operation on closed file
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:58:19,352 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:59:05,759 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:59:05,759 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:59:06,185 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: I/O operation on closed file
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:59:06,185 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 534, in process_ca_statement
    writer.close()
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/pandas/io/excel/_base.py", line 1357, in close
    self._save()
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/pandas/io/excel/_openpyxl.py", line 110, in _save
    self.book.save(self._handles.handle)
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/workbook/workbook.py", line 386, in save
    save_workbook(self, filename)
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/writer/excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "/Users/kapweb/micromamba/lib/python3.9/zipfile.py", line 1272, in __init__
    self.start_dir = self.fp.tell()
ValueError: I/O operation on closed file
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:59:06,185 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:59:15,636 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:59:15,636 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:59:16,072 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Erreur lors du traitement: I/O operation on closed file
Échec du traitement pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 0/2 fichiers traités avec succès
Le traitement automatique a échoué.

2025-03-22 11:59:16,073 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
Traceback (most recent call last):
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/process_ca_pdf.py", line 534, in process_ca_statement
    writer.close()\
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/pandas/io/excel/_base.py", line 1357, in close
    self._save()
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/pandas/io/excel/_openpyxl.py", line 110, in _save
    self.book.save(self._handles.handle)
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/workbook/workbook.py", line 386, in save
    save_workbook(self, filename)
  File "/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/writer/excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "/Users/kapweb/micromamba/lib/python3.9/zipfile.py", line 1272, in __init__
    self.start_dir = self.fp.tell()
ValueError: I/O operation on closed file
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:59:16,073 - ca_api - ERROR - Échec du traitement avec code: 1
2025-03-22 11:59:23,910 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:59:23,910 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:59:25,680 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:59:25,680 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:59:25,680 - ca_api - INFO - Traitement terminé avec succès
