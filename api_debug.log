2025-03-22 11:28:50,396 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:28:50,396 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:28:54,966 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 2/2 comptes traités avec succès

2025-03-22 11:28:54,967 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:30:18,231 - ca_api - INFO - Début de téléchargement avec les paramètres: {'account_number': None, 'start_date': None, 'end_date': None, 'force': False}
2025-03-22 11:30:18,231 - ca_api - DEBUG - Commande de téléchargement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python get_credit_agricole.py
2025-03-22 11:30:22,048 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Période: 01/02/2025 - 28/02/2025
Répertoire de destination: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Nombre de comptes à traiter: 2
Authentification réussie

--- Traitement du compte 70089352734 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['70089352734'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'70089352734': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

--- Traitement du compte 72029382655 ---
Téléchargement des opérations vers /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Téléchargement depuis https://www.credit-agricole.fr/ca-centreloire/professionnel/operations/operations-courantes/telechargement/jcr:content.telechargementServlet.json
Paramètres: {'comptes': ['72029382655'], 'format': 'xlsx', 'debut': '01/02/2025', 'fin': '28/02/2025', 'type': 'm', 'dateDebutList': {'72029382655': '01/02/2025'}}
Opérations téléchargées avec succès dans /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Pour traiter ce fichier, utilisez: python process_ca_pdf.py --input /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx --output /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02

Traitement terminé: 2/2 comptes traités avec succès

2025-03-22 11:30:22,048 - ca_api - INFO - Téléchargement terminé avec succès
2025-03-22 11:31:01,376 - ca_api - INFO - Début de traitement avec les paramètres: {'account_number': None, 'file_path': None}
2025-03-22 11:31:01,377 - ca_api - DEBUG - Commande de traitement: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/bin/python process_ca_pdf.py
2025-03-22 11:31:04,203 - ca_api - DEBUG - Sortie standard: Utilisation du fichier .env par défaut
Mode automatique - traitement de tous les fichiers du mois précédent
Fichiers trouvés: 2

--- Traitement du fichier pour le compte 70089352734 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/70089352734.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Fichier lu avec en-tête à la ligne 10, colonnes trouvées: ['Date', 'Libellé', 'Débit euros', 'Crédit euros']
Échantillon de données traitées:
        Date  ... Montant
0 2025-02-28  ...  -340.8
1 2025-02-28  ...  -128.7
2 2025-02-28  ...    22.7
3 2025-02-27  ...  -500.0
4 2025-02-26  ...    -7.0

[5 rows x 5 columns]
Traitement terminé. Fichier généré: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/ca_operations_20250322.xlsx
Traitement réussi pour 70089352734

--- Traitement du fichier pour le compte 72029382655 ---
Traitement du fichier: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02/72029382655.xlsx
Répertoire de sortie: /Users/kapweb/Library/CloudStorage/GoogleDrive-damien.dj@gmail.com/Mon Drive/Compta/2025/02
Erreur lors de la tentative de lecture avec header=8: Passed header=[8], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=9: Passed header=[9], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=10: Passed header=[10], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=11: Passed header=[11], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=12: Passed header=[12], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=13: Passed header=[13], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=14: Passed header=[14], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=15: Passed header=[15], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=16: Passed header=[16], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=17: Passed header=[17], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=18: Passed header=[18], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=19: Passed header=[19], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=20: Passed header=[20], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=21: Passed header=[21], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=22: Passed header=[22], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=23: Passed header=[23], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=24: Passed header=[24], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=25: Passed header=[25], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=26: Passed header=[26], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=27: Passed header=[27], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=28: Passed header=[28], len of 1, but only 8 lines in file (sheet: 0)
Erreur lors de la tentative de lecture avec header=29: Passed header=[29], len of 1, but only 8 lines in file (sheet: 0)
Tentative de détection alternative de l'en-tête...
Impossible de trouver les en-têtes du tableau. Essai de lecture directe...
Aperçu des premières lignes du fichier:
Ligne 1: ['Téléchargement du 22/03/2025', nan, nan]
Ligne 2: [nan, nan, nan]
Ligne 3: ['SARL KAPWEB                                                     ', nan, nan]
Ligne 4: ['Compte Excédent Professionnel carte n° 72029382655', nan, nan]
Ligne 5: [nan, nan, nan]
Ligne 6: [nan, 'Solde au 22/03/2025', ' 108,90 €']
Ligne 7: [nan, nan, nan]
Ligne 8: ['Aucune opération effectuée sur ce compte sur la période renseignée', nan, nan]
Impossible de trouver l'en-tête. Utilisation de header=0 par défaut.
Fichier lu avec en-tête à la ligne 1, colonnes trouvées: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Colonnes manquantes: ['Date', 'Libellé', 'Débit', 'Crédit']
Colonnes disponibles: ['Téléchargement du 22/03/2025', 'Unnamed: 1', 'Unnamed: 2']
Impossible de trouver toutes les colonnes requises. Traitement impossible.
Échec du traitement pour 72029382655

Traitement terminé: 1/2 fichiers traités avec succès
Le traitement automatique a réussi.

2025-03-22 11:31:04,203 - ca_api - ERROR - Erreur standard: /Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")
/Volumes/CloudDatas/SyncMac/kAi/Servers/CreditAgricole/.venv/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:237: UserWarning: Workbook contains no default style, apply openpyxl's default
  warn("Workbook contains no default style, apply openpyxl's default")

2025-03-22 11:31:04,204 - ca_api - INFO - Traitement terminé avec succès
